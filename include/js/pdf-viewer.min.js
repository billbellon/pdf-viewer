(function(pdfjsLib){var PDF;var RESIZE_TIMER;var PDF_FORMAT;document.addEventListener("DOMContentLoaded",init);function init(){var query=getQueryStringArray();var pdfURL=query["pdf"];if(!validatePDF_URL(pdfURL)){document.getElementById("pdf-container").innerHTML='<div id="error-message">'+"<p>Invalid PDF</p>"+"</div>";return}PDF_FORMAT=getPdfFormat(query);document.getElementById("pdf-download").setAttribute("href",pdfURL);document.getElementById("pdf-container").classList.add(PDF_FORMAT);pdfjsLib.GlobalWorkerOptions.workerSrc="./include/js/pdfjs-2.0.943-dist/build/pdf.worker.min.js";if(PDF_FORMAT==="portrait"){PDF={pdfDoc:{left:null,right:null},pageNum:{left:1,right:2},pageRendering:{left:false,right:false},pageNumPending:{left:null,right:null},canvas:{left:document.getElementById("left-canvas"),right:document.getElementById("right-canvas")},zoom:1,zoomFactor:.2};PDF.ctx={left:PDF.canvas.left.getContext("2d"),right:PDF.canvas.right.getContext("2d")}}else{PDF={pdfDoc:{center:null},pageNum:{center:1},pageRendering:{center:false},pageNumPending:{center:null},canvas:{center:document.getElementById("center-canvas")},zoom:1,zoomFactor:.2};PDF.ctx={center:PDF.canvas.center.getContext("2d")}}document.getElementById("next").addEventListener("click",onNextPage);document.getElementById("prev").addEventListener("click",onPrevPage);document.getElementById("zoomout").addEventListener("click",onZoomOut);document.getElementById("zoomin").addEventListener("click",onZoomIn);document.getElementById("banner").style.display="none";document.getElementById("pdf-container").style.display="none";document.getElementById("downloading-pdf-loading-icon").style.display="block";initPdfjsLib(pdfURL)}function initPdfjsLib(pdfURL){pdfjsLib.getDocument(pdfURL).then(function(pdfDoc_){document.getElementById("banner").style.display="block";document.getElementById("pdf-container").style.display="block";document.getElementById("downloading-pdf-loading-icon").style.display="none";if(PDF_FORMAT==="portrait"){PDF.pdfDoc.left=pdfDoc_;PDF.pdfDoc.right=pdfDoc_;document.getElementById("page_count").textContent=PDF.pdfDoc.left.numPages}else{PDF.pdfDoc.center=pdfDoc_;document.getElementById("page_count").textContent=PDF.pdfDoc.center.numPages}setTitle(pdfDoc_);window.addEventListener("resize",function(){window.clearTimeout(RESIZE_TIMER);RESIZE_TIMER=window.setTimeout(function(){if(PDF_FORMAT==="portrait"){renderView(PDF.pageNum.left,"left");renderView(PDF.pageNum.right,"right")}else{renderView(PDF.pageNum.center,"center")}},250)});if(PDF_FORMAT==="portrait"){renderView(PDF.pageNum.left,"left");renderView(PDF.pageNum.right,"right")}else{renderView(PDF.pageNum.center,"center")}})}function renderView(page_num,side){if(side==="right"&&PDF.pageNum.right>PDF.pdfDoc.right.numPages){PDF.canvas[side].style.display="none";return}else{PDF.canvas[side].style.display="inline-block"}PDF.pageRendering[side]=true;disableButtons();PDF.pdfDoc[side].getPage(page_num).then(function(page){var borderThickness=1;var desiredWidth;if(side==="center"){desiredWidth=windowWidth()-borderThickness}else{desiredWidth=windowWidth()/2-borderThickness}var desiredHeight=windowHeight()-document.getElementById("banner").offsetHeight;desiredWidth=desiredWidth*PDF.zoom;desiredHeight=desiredHeight*PDF.zoom;var viewport=page.getViewport(1);var scale1=desiredWidth/viewport.width;var scale2=desiredHeight/viewport.height;var scaledViewport;if(scale1>=scale2){scaledViewport=page.getViewport(scale2)}else{scaledViewport=page.getViewport(scale1)}PDF.canvas[side].height=desiredHeight;PDF.canvas[side].width=desiredWidth;var h=0;var diff;if(side==="left"){diff=PDF.canvas.left.width-scaledViewport.width;if(diff>0){h=diff}}else if(side==="center"){diff=PDF.canvas.center.width-scaledViewport.width;if(diff>0){h=diff/2}}var renderContext={canvasContext:PDF.ctx[side],viewport:scaledViewport,transform:[1,0,0,1,h,0]};var renderTask=page.render(renderContext);renderTask.promise.then(function(){PDF.pageRendering[side]=false;enableButtons();if(PDF.pageNumPending[side]!==null){renderView(PDF.pageNumPending[side],page);PDF.pageNumPending[side]=null}})});if(side==="left"||side==="center"){document.getElementById("page_num").textContent=page_num}}function disableButtons(){document.getElementById("prev").setAttribute("disabled","disabled");document.getElementById("next").setAttribute("disabled","disabled");showLoadingIcons()}function enableButtons(){var enableButtons=PDF_FORMAT==="portrait"&&PDF.pageRendering.left===false&&PDF.pageRendering.right===false||PDF_FORMAT==="landscape"&&PDF.pageRendering.center===false;if(enableButtons){document.getElementById("prev").removeAttribute("disabled");document.getElementById("next").removeAttribute("disabled")}showLoadingIcons()}function showLoadingIcons(){if(PDF_FORMAT==="portrait"){var icons=document.querySelectorAll(".loading-icon-left");var i;if(PDF.pageRendering.left){for(i=0;i<icons.length;i++){icons[i].style.display="inline-block"}PDF.canvas.left.style.display="none"}else{for(i=0;i<icons.length;i++){icons[i].style.display="none"}PDF.canvas.left.style.display="inline-block"}if(PDF.pageRendering.right){document.getElementById("loading-icon-right").style.display="inline-block";PDF.canvas.right.style.display="none"}else{document.getElementById("loading-icon-right").style.display="none";if(PDF.pageNum.right>PDF.pdfDoc.right.numPages){PDF.canvas.right.style.display="none"}else{PDF.canvas.right.style.display="inline-block"}}}else{if(PDF.pageRendering.center){document.getElementById("loading-icon-center").style.display="inline-block";PDF.canvas.center.style.display="none"}else{document.getElementById("loading-icon-center").style.display="none";if(PDF.pageNum.center>PDF.pdfDoc.center.numPages){PDF.canvas.center.style.display="none"}else{PDF.canvas.center.style.display="inline-block"}}}}function windowWidth(){return window.innerWidth}function windowHeight(){return window.innerHeight}function queueRenderPage(side,page_num){if(PDF.pageRendering[side]){PDF.pageNumPending[side]=page_num}else{renderView(page_num,side)}}function onPrevPage(){if(PDF_FORMAT==="portrait"){if(PDF.pageRendering.left||PDF.pageRendering.right){return}if(PDF.pageNum.left<=1){return}if(showingPageRightAfterCoverPage()){PDF.pageNum.left=PDF.pageNum.left-1;PDF.pageNum.right=PDF.pageNum.right-1}else{PDF.pageNum.left=PDF.pageNum.left-2;PDF.pageNum.right=PDF.pageNum.right-2}queueRenderPage("left",PDF.pageNum.left);queueRenderPage("right",PDF.pageNum.right)}else{if(PDF.pageRendering.center){return}if(PDF.pageNum.center<=1){return}PDF.pageNum.center=PDF.pageNum.center-1;queueRenderPage("center",PDF.pageNum.center)}}function onNextPage(){if(PDF_FORMAT==="portrait"){if(PDF.pageRendering.left||PDF.pageRendering.right){return}if(PDF.pageNum.left>=PDF.pdfDoc.left.numPages-1){return}if(showingCoverPage()){PDF.pageNum.left=PDF.pageNum.left+1;PDF.pageNum.right=PDF.pageNum.right+1}else{PDF.pageNum.left=PDF.pageNum.left+2;PDF.pageNum.right=PDF.pageNum.right+2}queueRenderPage("left",PDF.pageNum.left);queueRenderPage("right",PDF.pageNum.right)}else{if(PDF.pageRendering.center){return}if(PDF.pageNum.center>=PDF.pdfDoc.center.numPages){return}PDF.pageNum.center=PDF.pageNum.center+1;queueRenderPage("center",PDF.pageNum.center)}}function showingCoverPage(){return PDF.pageNum.left===1}function showingPageRightAfterCoverPage(){return PDF.pageNum.left===2}function onZoomOut(){PDF.zoom=PDF.zoom*(1-PDF.zoomFactor);if(PDF.zoom<1)PDF.zoom=1;if(PDF_FORMAT==="portrait"){renderView(PDF.pageNum.left,"left");renderView(PDF.pageNum.right,"right")}else{renderView(PDF.pageNum.center,"center")}}function onZoomIn(){PDF.zoom=PDF.zoom*(1+PDF.zoomFactor);if(PDF_FORMAT==="portrait"){renderView(PDF.pageNum.left,"left");renderView(PDF.pageNum.right,"right")}else{renderView(PDF.pageNum.center,"center")}}function setTitle(pdfDoc){pdfDoc.getMetadata().then(function(metadata){var title=metadata.metadata.get("dc:title");var titleElem=document.getElementById("title");if(!empty(title)){titleElem.innerText=title;document.title=title}else{titleElem.parentNode.removeChild(titleElem);document.title="PDF -- SSEC"}})}function empty(mixedVar){var undef;var key;var i;var len;var emptyValues=[undef,null,false,0,"","0"];for(i=0,len=emptyValues.length;i<len;i++){if(mixedVar===emptyValues[i]){return true}}if(typeof mixedVar==="object"){for(key in mixedVar){if(mixedVar.hasOwnProperty(key)){return false}}return true}return false}function getPdfFormat(query){var pdf_format=query.hasOwnProperty("pdf_format")?query["pdf_format"]:"portrait";if(!inArray(pdf_format,["portrait","landscape"])){pdf_format="portrait"}return pdf_format}function inArray(needle,haystack){var length=haystack.length;for(var i=0;i<length;i++){if(haystack[i]===needle)return true}return false}function getQueryStringArray(){var params=[];var rExp=/\?.*$/;var queryStringIndex=window.top.location.href.search(rExp);if(queryStringIndex<0)return params;var queryString=window.top.location.href.substr(queryStringIndex+1);rExp=/#/;var ind=queryString.search(rExp);if(ind!==-1){queryString=queryString.substr(0,ind)}var paramStrings=queryString.split("&");var k=[];for(var i=0;i<paramStrings.length;i++){k=paramStrings[i].split("=");params[k[0]]=k[1]}return params}function ParsedUrl(url){var parser=document.createElement("a");parser.href=url;if(parser.host===""){var newProtocolAndHost=window.location.protocol+"//"+window.location.host;if(url.charAt(1)==="/"){parser.href=newProtocolAndHost+url}else{var currentFolder=("/"+parser.pathname).match(/.*\//)[0];parser.href=newProtocolAndHost+currentFolder+url}}var properties=["host","hostname","hash","href","port","protocol","search"];for(var i=0,n=properties.length;i<n;i++){this[properties[i]]=parser[properties[i]]}this.pathname=(parser.pathname.charAt(0)!=="/"?"/":"")+parser.pathname}function fileExtension(filename){var re=/(?:\.([^.]+))?$/;var file_extension=re.exec(filename);if(file_extension.length===2){return file_extension[1].toLowerCase()}else{return""}}function validatePDF_URL(pdfURL){var valid_hostname=window.location.hostname;var parsed_url=new ParsedUrl(pdfURL);if(parsed_url.hostname!==valid_hostname){return false}return fileExtension(pdfURL)==="pdf"}})(pdfjsLib);